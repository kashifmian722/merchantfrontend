{"version":3,"file":"button.base.js","sourceRoot":"","sources":["../../../../src/clr-core/common/base/button.base.ts"],"names":[],"mappings":"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","sourcesContent":["/*\n * Copyright (c) 2016-2020 VMware, Inc. All Rights Reserved.\n * This software is released under MIT license.\n * The full license information can be found in LICENSE in the root directory of this project.\n */\n\nimport { html, LitElement, query } from 'lit-element';\nimport { ifDefined } from 'lit-html/directives/if-defined';\n\nimport { property } from '../decorators/property';\nimport { querySlot } from '../decorators/query-slot';\nimport { KeyCodes } from './../enums/key-codes';\nimport { stopEvent } from './../utils/events';\n\n// @dynamic\nexport class CdsBaseButton extends LitElement {\n  @property({ type: Boolean })\n  readonly = false;\n  @property({ type: String })\n  role = 'button';\n  @property({ type: String })\n  type: 'button' | 'submit';\n  @property({ type: String })\n  name = '';\n  @property({ type: String })\n  value = '';\n  @property({ type: Boolean })\n  disabled = false;\n\n  @querySlot('a') private anchor: HTMLAnchorElement;\n\n  protected get hiddenButtonTemplate() {\n    return this.readonly\n      ? html``\n      : html`\n      <button\n          aria-hidden=\"true\"\n          ?disabled=\"${this.disabled}\"\n          tabindex=\"-1\"\n          style=\"display: none\"\n          value=\"${ifDefined(this.value)}\"\n          name=\"${ifDefined(name)}\"\n          type=\"${ifDefined(this.type)}\"\n        ></button>`;\n  }\n\n  @query('button') private templateButton: HTMLButtonElement;\n  private hiddenButton: HTMLButtonElement;\n\n  protected render() {\n    return html`\n      <slot></slot>\n      ${this.hiddenButtonTemplate}\n    `;\n  }\n\n  protected firstUpdated(props: Map<string, any>) {\n    super.firstUpdated(props);\n    this.updateButtonAttributes();\n    this.setupNativeButtonBehavior();\n  }\n\n  protected updated(props: Map<string, any>) {\n    super.updated(props);\n    // if readonly or disabled attribute was updated, button attributes might need updating\n    if (props.has('readonly') || props.has('disabled')) {\n      this.updateButtonAttributes();\n    }\n  }\n\n  /**\n   * We have to append a hidden button outside the web component in the light DOM\n   * This allows us to trigger native submit events within a form element.\n   */\n  private setupNativeButtonBehavior() {\n    this.appendHiddenButton();\n    this.addEventListener('click', e => this.triggerNativeButtonBehavior(e));\n    this.addEventListener('keydown', e => this.emulateKeyBoardEventBehavior(e));\n  }\n\n  private triggerNativeButtonBehavior(event: Event) {\n    if (!this.readonly) {\n      if (this.disabled) {\n        stopEvent(event);\n      } else if (event.target === this && !event.defaultPrevented) {\n        this.hiddenButton.dispatchEvent(new MouseEvent('click', { relatedTarget: this, composed: true }));\n      }\n    }\n  }\n\n  private appendHiddenButton() {\n    if (!this.hiddenButton && this.templateButton) {\n      this.hiddenButton = this.appendChild(this.templateButton);\n    }\n  }\n\n  private emulateKeyBoardEventBehavior(e: KeyboardEvent) {\n    if (!this.anchor && (e.key === KeyCodes.Enter || e.code === KeyCodes.Space)) {\n      this.click();\n      stopEvent(e);\n    }\n  }\n\n  private updateButtonAttributes() {\n    const oldRole = this.role;\n    const oldTabIndex = this.tabIndex;\n\n    if (this.anchor) {\n      this.readonly = true;\n      this.setAttribute('is-anchor', '');\n    }\n\n    if (this.readonly) {\n      this.removeAttribute('role');\n      this.removeAttribute('tabIndex');\n      this.appendHiddenButton();\n    } else {\n      this.role = 'button';\n      this.tabIndex = this.disabled ? -1 : 0;\n    }\n\n    if (this.role !== oldRole) {\n      this.requestUpdate('role', oldRole);\n    }\n\n    if (this.tabIndex !== oldTabIndex) {\n      this.requestUpdate('tabIndex', oldTabIndex);\n    }\n  }\n}\n"]}